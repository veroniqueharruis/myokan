---
import Dropdown from "./dropdown.astro"; // Recursive import
const { title, children, lastItem = false } = Astro.props;
---

<li class={`relative ${lastItem ? '' : 'mr-2'}`} x-data="{ open: false }">
  <!-- Toggle button -->
  <button
    type="button"
    class="flex justify-between items-center w-full lg:w-auto lg:px-3 py-2 text-gray-600 hover:text-gray-900 font-medium"
    @click="open = !open"
  >
    {title}
    {children && (
      <svg
        class="ml-1 w-3 h-3 flex-shrink-0 transition-transform duration-200"
        :class="{ 'rotate-180': open }"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path d="M5.23 7.21L10 11.97l4.77-4.76 1.06 1.06L10 14.09 4.17 8.27l1.06-1.06z" />
      </svg>
    )}
  </button>

  <!-- Submenu -->
  {children && (
    <ul
      x-show="open"
      class="absolute left-0 mt-1 w-full lg:w-48 bg-white shadow-lg rounded-md z-50"
      x-transition
    >
      {children.map((child, index) => (
        child.children ? (
          <Dropdown
            title={child.title}
            children={child.children}
            lastItem={index === children.length - 1}
          />
        ) : (
          <li key={child.title}>
            <a
              href={child.path}
              class="block px-4 py-2 text-gray-600 hover:bg-gray-100 hover:text-gray-900"
            >
              {child.title}
            </a>
          </li>
        )
      ))}
    </ul>
  )}
</li>
